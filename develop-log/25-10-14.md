## lyingloong 25-10-14

```
(base) wanghao@amdic:~/lyingloong$ conda activate rocm_ai
(rocm_ai) wanghao@amdic:~/lyingloong$ bash script/qwen3-4b.sh 
[load_model_and_tokenizer] Loading model and tokenizer...
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.72it/s]
[ModelBenchmarker: __init__] Device: cuda
[ModelBenchmarker: __init__] Set num_threads to 24
[ModelBenchmarker: __init__] Set num_interop_threads to 4

=== 开始测试: Qwen3-4B ===

--- 测试配置: Qwen3-4B_输入长度_3_生成_50 ---
The following generation flags are not valid and may be ignored: ['top_k']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
  运行 1/5: 延迟=1.3832s, 生成50 tokens, 吞吐量=36.15 t/s, 显存=7.59GB
  运行 2/5: 延迟=1.3810s, 生成50 tokens, 吞吐量=36.21 t/s, 显存=7.59GB
  运行 3/5: 延迟=1.3819s, 生成50 tokens, 吞吐量=36.18 t/s, 显存=7.59GB
  运行 4/5: 延迟=1.3827s, 生成50 tokens, 吞吐量=36.16 t/s, 显存=7.59GB
  运行 5/5: 延迟=1.3837s, 生成50 tokens, 吞吐量=36.14 t/s, 显存=7.59GB

--- 测试配置: Qwen3-4B_输入长度_3_生成_100 ---
  运行 1/5: 延迟=2.7666s, 生成100 tokens, 吞吐量=36.14 t/s, 显存=7.59GB
  运行 2/5: 延迟=2.7686s, 生成100 tokens, 吞吐量=36.12 t/s, 显存=7.59GB
  运行 3/5: 延迟=2.7690s, 生成100 tokens, 吞吐量=36.11 t/s, 显存=7.59GB
  运行 4/5: 延迟=2.7682s, 生成100 tokens, 吞吐量=36.12 t/s, 显存=7.59GB
  运行 5/5: 延迟=2.7707s, 生成100 tokens, 吞吐量=36.09 t/s, 显存=7.59GB

--- 测试配置: Qwen3-4B_输入长度_26_生成_50 ---
  运行 1/5: 延迟=1.3868s, 生成50 tokens, 吞吐量=36.05 t/s, 显存=7.59GB
  运行 2/5: 延迟=1.3870s, 生成50 tokens, 吞吐量=36.05 t/s, 显存=7.59GB
  运行 3/5: 延迟=1.3880s, 生成50 tokens, 吞吐量=36.02 t/s, 显存=7.59GB
  运行 4/5: 延迟=1.3880s, 生成50 tokens, 吞吐量=36.02 t/s, 显存=7.59GB
  运行 5/5: 延迟=1.3868s, 生成50 tokens, 吞吐量=36.05 t/s, 显存=7.59GB

--- 测试配置: Qwen3-4B_输入长度_26_生成_100 ---
  运行 1/5: 延迟=2.7774s, 生成100 tokens, 吞吐量=36.00 t/s, 显存=7.60GB
  运行 2/5: 延迟=2.7771s, 生成100 tokens, 吞吐量=36.01 t/s, 显存=7.60GB
  运行 3/5: 延迟=2.7775s, 生成100 tokens, 吞吐量=36.00 t/s, 显存=7.60GB
  运行 4/5: 延迟=2.7792s, 生成100 tokens, 吞吐量=35.98 t/s, 显存=7.60GB
  运行 5/5: 延迟=2.7790s, 生成100 tokens, 吞吐量=35.98 t/s, 显存=7.60GB

================================================================================
性能测试汇总 (4 种配置)
================================================================================
配置名称                           | 平均延迟(s)      | 吞吐量(t/s)     | 峰值显存(GB)    
--------------------------------------------------------------------------------
Qwen3-4B_输入长度_3_生成_50... | 1.3825      | 36.17       | 7.59
Qwen3-4B_输入长度_3_生成_100... | 2.7686      | 36.12       | 7.59
Qwen3-4B_输入长度_26_生成_50... | 1.3873      | 36.04       | 7.59
Qwen3-4B_输入长度_26_生成_100... | 2.7780      | 36.00       | 7.60
================================================================================


=== 运行性能分析 ===
[W1014 07:30:38.373553261 collection.cpp:1116] Warning: ROCTracer produced duplicate flow start: 1 (function operator())

=== 性能分析摘要 (按CUDA时间排序) ===
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                        model_inference         0.00%       0.000us         0.00%       0.000us       0.000us        4.121s       166.95%        4.121s        4.121s           0 B           0 B           0 B           0 B             1  
                                        model_inference        31.32%        1.291s       100.00%        4.122s        4.122s       0.000us         0.00%        2.468s        2.468s           0 B         -56 B           0 B      -1.96 GB             1  
                                           aten::matmul         2.40%      98.908ms        17.43%     718.539ms      28.289us       0.000us         0.00%        1.622s      63.868us           0 B           0 B     244.21 MB           0 B         25400  
                                           aten::linear         0.91%      37.368ms        20.59%     848.785ms      33.549us       0.000us         0.00%        1.622s      64.104us           0 B           0 B     244.16 MB           0 B         25300  
                                               aten::mm        10.66%     439.354ms        12.93%     533.020ms      21.068us        1.622s        65.71%        1.622s      64.104us           0 B           0 B     244.16 MB     244.16 MB         25300  
Cijk_Alik_Bljk_HHS_BH_MT64x64x32_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us     841.346ms        34.09%     841.346ms     115.253us           0 B           0 B           0 B           0 B          7300  
Cijk_Alik_Bljk_HHS_BH_MT32x32x32_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us     509.421ms        20.64%     509.421ms      70.753us           0 B           0 B           0 B           0 B          7200  
                                              aten::mul         5.27%     217.264ms         8.04%     331.452ms       6.993us     236.915ms         9.60%     236.915ms       4.998us           0 B           0 B     356.70 MB     356.70 MB         47400  
Cijk_Alik_Bljk_HHS_BH_MT32x32x32_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us     136.484ms         5.53%     136.484ms      37.912us           0 B           0 B           0 B           0 B          3600  
Cijk_Alik_Bljk_HHS_BH_MT32x32x32_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us     134.572ms         5.45%     134.572ms      18.691us           0 B           0 B           0 B           0 B          7200  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 4.122s
Self CUDA time total: 2.468s

[load_model_and_tokenizer] Loading model and tokenizer...
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.70it/s]
[load_model_and_tokenizer] Applying int8 quantization using torchao...
[load_model_and_tokenizer] Model quantized to int8.
[ModelBenchmarker: __init__] Device: cuda
[ModelBenchmarker: __init__] Set num_threads to 24
[ModelBenchmarker: __init__] Set num_interop_threads to 4

=== 开始测试: Qwen3-4B ===

--- 测试配置: Qwen3-4B_输入长度_3_生成_50 ---
The following generation flags are not valid and may be ignored: ['top_k']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
  运行 1/5: 延迟=2.2744s, 生成50 tokens, 吞吐量=21.98 t/s, 显存=5.27GB
  运行 2/5: 延迟=2.2737s, 生成50 tokens, 吞吐量=21.99 t/s, 显存=5.27GB
  运行 3/5: 延迟=2.2760s, 生成50 tokens, 吞吐量=21.97 t/s, 显存=5.27GB
  运行 4/5: 延迟=2.2754s, 生成50 tokens, 吞吐量=21.97 t/s, 显存=5.27GB
  运行 5/5: 延迟=2.2767s, 生成50 tokens, 吞吐量=21.96 t/s, 显存=5.27GB

--- 测试配置: Qwen3-4B_输入长度_3_生成_100 ---
  运行 1/5: 延迟=4.5594s, 生成100 tokens, 吞吐量=21.93 t/s, 显存=5.28GB
  运行 2/5: 延迟=4.5566s, 生成100 tokens, 吞吐量=21.95 t/s, 显存=5.28GB
  运行 3/5: 延迟=4.5582s, 生成100 tokens, 吞吐量=21.94 t/s, 显存=5.28GB
  运行 4/5: 延迟=4.5582s, 生成100 tokens, 吞吐量=21.94 t/s, 显存=5.28GB
  运行 5/5: 延迟=4.5586s, 生成100 tokens, 吞吐量=21.94 t/s, 显存=5.28GB

--- 测试配置: Qwen3-4B_输入长度_26_生成_50 ---
  运行 1/5: 延迟=2.2827s, 生成50 tokens, 吞吐量=21.90 t/s, 显存=5.28GB
  运行 2/5: 延迟=2.2809s, 生成50 tokens, 吞吐量=21.92 t/s, 显存=5.28GB
  运行 3/5: 延迟=2.2822s, 生成50 tokens, 吞吐量=21.91 t/s, 显存=5.28GB
  运行 4/5: 延迟=2.2808s, 生成50 tokens, 吞吐量=21.92 t/s, 显存=5.28GB
  运行 5/5: 延迟=2.2829s, 生成50 tokens, 吞吐量=21.90 t/s, 显存=5.28GB

--- 测试配置: Qwen3-4B_输入长度_26_生成_100 ---
  运行 1/5: 延迟=4.5664s, 生成100 tokens, 吞吐量=21.90 t/s, 显存=5.28GB
  运行 2/5: 延迟=4.5651s, 生成100 tokens, 吞吐量=21.91 t/s, 显存=5.28GB
  运行 3/5: 延迟=4.5658s, 生成100 tokens, 吞吐量=21.90 t/s, 显存=5.28GB
  运行 4/5: 延迟=4.5653s, 生成100 tokens, 吞吐量=21.90 t/s, 显存=5.28GB
  运行 5/5: 延迟=4.5667s, 生成100 tokens, 吞吐量=21.90 t/s, 显存=5.28GB

================================================================================
性能测试汇总 (4 种配置)
================================================================================
配置名称                           | 平均延迟(s)      | 吞吐量(t/s)     | 峰值显存(GB)    
--------------------------------------------------------------------------------
Qwen3-4B_输入长度_3_生成_50... | 2.2752      | 21.98       | 5.27
Qwen3-4B_输入长度_3_生成_100... | 4.5582      | 21.94       | 5.28
Qwen3-4B_输入长度_26_生成_50... | 2.2819      | 21.91       | 5.28
Qwen3-4B_输入长度_26_生成_100... | 4.5658      | 21.90       | 5.28
================================================================================


=== 运行性能分析 ===
[W1014 07:34:29.729798205 collection.cpp:1116] Warning: ROCTracer produced duplicate flow start: 1 (function operator())

=== 性能分析摘要 (按CUDA时间排序) ===
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                        model_inference         0.00%       0.000us         0.00%       0.000us       0.000us        6.370s       151.97%        6.370s        6.370s           0 B           0 B           0 B           0 B             1  
                                        model_inference        38.32%        2.441s       100.00%        6.371s        6.371s       0.000us         0.00%        4.192s        4.192s           0 B         -88 B           0 B    -756.69 GB             1  
                                            aten::copy_         3.37%     214.891ms         6.69%     426.423ms       7.728us        2.406s        57.41%        2.406s      43.613us           0 B           0 B           0 B           0 B         55176  
                                               aten::to         0.95%      60.424ms        12.76%     813.300ms       8.527us       0.000us         0.00%        2.406s      25.223us           0 B           0 B     754.76 GB           0 B         95376  
                                         aten::_to_copy         2.62%     166.960ms        11.82%     752.877ms      13.720us       0.000us         0.00%        2.406s      43.839us           0 B           0 B     754.76 GB           0 B         54875  
void at::native::elementwise_kernel_manual_unroll<12...         0.00%       0.000us         0.00%       0.000us       0.000us        2.289s        54.61%        2.289s      90.472us           0 B           0 B           0 B           0 B         25300  
                                               aten::mm         8.16%     519.745ms         9.47%     603.651ms      23.860us     966.039ms        23.05%     966.039ms      38.183us           0 B           0 B     244.16 MB     244.16 MB         25300  
Cijk_Alik_Bljk_HHS_BH_MT64x64x32_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us     471.830ms        11.26%     471.830ms      64.634us           0 B           0 B           0 B           0 B          7300  
Cijk_Alik_Bljk_HHS_BH_MT32x32x32_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us     309.814ms         7.39%     309.814ms      43.030us           0 B           0 B           0 B           0 B          7200  
                                              aten::mul         6.50%     414.043ms         9.68%     616.638ms       8.482us     301.621ms         7.20%     301.621ms       4.149us           0 B           0 B     600.86 MB     600.86 MB         72700  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 6.371s
Self CUDA time total: 4.192s

[load_model_and_tokenizer] Loading model and tokenizer...
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.70it/s]
Traceback (most recent call last):
  File "/home/wanghao/lyingloong/benchmarker/run.py", line 92, in <module>
    main()
  File "/home/wanghao/lyingloong/benchmarker/run.py", line 65, in main
    model, tokenizer = load_model_and_tokenizer(
  File "/home/wanghao/lyingloong/benchmarker/run.py", line 32, in load_model_and_tokenizer
    raise NotImplementedError("GPTQ quantization not implemented in this example.")
NotImplementedError: GPTQ quantization not implemented in this example.
[qwen3-4b.sh] Done.
```
```
GPTQ:
=== 开始测试: Qwen3-4B ===

--- 测试配置: Qwen3-4B_输入长度_3_生成_50 ---
The following generation flags are not valid and may be ignored: ['top_k']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
  运行 1/5: 延迟=2.1013s, 生成50 tokens, 吞吐量=23.79 t/s, 显存=2.59GB
  运行 2/5: 延迟=2.0994s, 生成50 tokens, 吞吐量=23.82 t/s, 显存=2.59GB
  运行 3/5: 延迟=2.1589s, 生成50 tokens, 吞吐量=23.16 t/s, 显存=2.59GB
  运行 4/5: 延迟=2.1703s, 生成50 tokens, 吞吐量=23.04 t/s, 显存=2.59GB
  运行 5/5: 延迟=2.1663s, 生成50 tokens, 吞吐量=23.08 t/s, 显存=2.59GB

--- 测试配置: Qwen3-4B_输入长度_3_生成_100 ---
  运行 1/5: 延迟=4.3428s, 生成100 tokens, 吞吐量=23.03 t/s, 显存=2.59GB
  运行 2/5: 延迟=4.3468s, 生成100 tokens, 吞吐量=23.01 t/s, 显存=2.59GB
  运行 3/5: 延迟=4.3532s, 生成100 tokens, 吞吐量=22.97 t/s, 显存=2.59GB
  运行 4/5: 延迟=4.3525s, 生成100 tokens, 吞吐量=22.98 t/s, 显存=2.59GB
  运行 5/5: 延迟=4.3529s, 生成100 tokens, 吞吐量=22.97 t/s, 显存=2.59GB

--- 测试配置: Qwen3-4B_输入长度_26_生成_50 ---
  运行 1/5: 延迟=2.1807s, 生成50 tokens, 吞吐量=22.93 t/s, 显存=2.59GB
  运行 2/5: 延迟=2.1798s, 生成50 tokens, 吞吐量=22.94 t/s, 显存=2.59GB
  运行 3/5: 延迟=2.1806s, 生成50 tokens, 吞吐量=22.93 t/s, 显存=2.59GB
  运行 4/5: 延迟=2.1834s, 生成50 tokens, 吞吐量=22.90 t/s, 显存=2.59GB
  运行 5/5: 延迟=2.1823s, 生成50 tokens, 吞吐量=22.91 t/s, 显存=2.59GB

--- 测试配置: Qwen3-4B_输入长度_26_生成_100 ---
  运行 1/5: 延迟=4.3740s, 生成100 tokens, 吞吐量=22.86 t/s, 显存=2.60GB
  运行 2/5: 延迟=4.3667s, 生成100 tokens, 吞吐量=22.90 t/s, 显存=2.60GB
  运行 3/5: 延迟=4.3712s, 生成100 tokens, 吞吐量=22.88 t/s, 显存=2.60GB
  运行 4/5: 延迟=4.3706s, 生成100 tokens, 吞吐量=22.88 t/s, 显存=2.60GB
  运行 5/5: 延迟=4.3727s, 生成100 tokens, 吞吐量=22.87 t/s, 显存=2.60GB

================================================================================
性能测试汇总 (4 种配置)
================================================================================
配置名称                           | 平均延迟(s)      | 吞吐量(t/s)     | 峰值显存(GB)    
--------------------------------------------------------------------------------
Qwen3-4B_输入长度_3_生成_50... | 2.1393      | 23.38       | 2.59
Qwen3-4B_输入长度_3_生成_100... | 4.3497      | 22.99       | 2.59
Qwen3-4B_输入长度_26_生成_50... | 2.1814      | 22.92       | 2.59
Qwen3-4B_输入长度_26_生成_100... | 4.3710      | 22.88       | 2.60
================================================================================


=== 运行性能分析 ===
[W1014 11:37:34.784294983 collection.cpp:1116] Warning: ROCTracer produced duplicate flow start: 1 (function operator())

=== 性能分析摘要 (按CUDA时间排序) ===
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                        model_inference         0.00%       0.000us         0.00%       0.000us       0.000us        8.029s       249.10%        8.029s        8.029s           0 B           0 B           0 B           0 B             1  
                                        model_inference        28.65%        2.301s       100.00%        8.030s        8.030s       0.000us         0.00%        3.223s        3.223s           0 B         -64 B           0 B    -683.99 GB             1  
                                           aten::matmul         0.58%      46.361ms         9.42%     756.765ms      29.794us       0.000us         0.00%        1.128s      44.396us           0 B           0 B     244.21 MB           0 B         25400  
                                               aten::mm         7.50%     602.063ms         8.73%     701.023ms      27.708us        1.127s        34.97%        1.127s      44.554us           0 B           0 B     244.16 MB     244.16 MB         25300  
                       triton_poi_fused_index_mul_sub_0         2.92%     234.171ms         5.10%     409.376ms      16.245us        1.032s        32.03%        1.032s      40.963us           0 B           0 B           0 B           0 B         25200  
                       triton_poi_fused_index_mul_sub_0         0.00%       0.000us         0.00%       0.000us       0.000us        1.032s        32.03%        1.032s      40.963us           0 B           0 B           0 B           0 B         25200  
                             Torch-Compiled Region: 0/8         5.02%     403.228ms         7.18%     576.589ms      80.082us       0.000us         0.00%     487.909ms      67.765us           0 B           0 B     337.50 GB     337.50 GB          7200  
Cijk_Ailk_Bljk_HHS_BH_MT64x64x32_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us     365.925ms        11.35%     365.925ms      50.823us           0 B           0 B           0 B           0 B          7200  
Cijk_Ailk_Bljk_HHS_BH_MT64x64x32_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us     293.315ms         9.10%     293.315ms      81.476us           0 B           0 B           0 B           0 B          3600  
                                              aten::mul         3.28%     263.180ms         5.04%     404.507ms       8.534us     276.876ms         8.59%     276.876ms       5.841us           0 B           0 B     356.70 MB     356.70 MB         47400  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 8.030s
Self CUDA time total: 3.223s

[qwen3-4b.sh] Done.
New:
=== 开始测试: Qwen3-4B ===

--- 测试配置: Qwen3-4B_输入长度_3_生成_50 ---
The following generation flags are not valid and may be ignored: ['top_k']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
  运行 1/5: 延迟=2.1166s, 生成50 tokens, 吞吐量=23.62 t/s, 显存=2.59GB
  运行 2/5: 延迟=2.1063s, 生成50 tokens, 吞吐量=23.74 t/s, 显存=2.59GB
  运行 3/5: 延迟=2.1233s, 生成50 tokens, 吞吐量=23.55 t/s, 显存=2.59GB
  运行 4/5: 延迟=2.1319s, 生成50 tokens, 吞吐量=23.45 t/s, 显存=2.59GB
  运行 5/5: 延迟=2.1284s, 生成50 tokens, 吞吐量=23.49 t/s, 显存=2.59GB

--- 测试配置: Qwen3-4B_输入长度_3_生成_100 ---
  运行 1/5: 延迟=4.2606s, 生成100 tokens, 吞吐量=23.47 t/s, 显存=2.59GB

  运行 2/5: 延迟=4.2605s, 生成100 tokens, 吞吐量=23.47 t/s, 显存=2.59GB
  运行 3/5: 延迟=4.2647s, 生成100 tokens, 吞吐量=23.45 t/s, 显存=2.59GB
  运行 4/5: 延迟=4.2612s, 生成100 tokens, 吞吐量=23.47 t/s, 显存=2.59GB
  运行 5/5: 延迟=4.2673s, 生成100 tokens, 吞吐量=23.43 t/s, 显存=2.59GB

--- 测试配置: Qwen3-4B_输入长度_26_生成_50 ---
  运行 1/5: 延迟=2.1398s, 生成50 tokens, 吞吐量=23.37 t/s, 显存=2.59GB
  运行 2/5: 延迟=2.1432s, 生成50 tokens, 吞吐量=23.33 t/s, 显存=2.59GB
  运行 3/5: 延迟=2.1440s, 生成50 tokens, 吞吐量=23.32 t/s, 显存=2.59GB
  运行 4/5: 延迟=2.1432s, 生成50 tokens, 吞吐量=23.33 t/s, 显存=2.59GB
  运行 5/5: 延迟=2.1431s, 生成50 tokens, 吞吐量=23.33 t/s, 显存=2.59GB

--- 测试配置: Qwen3-4B_输入长度_26_生成_100 ---
  运行 1/5: 延迟=4.2940s, 生成100 tokens, 吞吐量=23.29 t/s, 显存=2.60GB
  运行 2/5: 延迟=4.2911s, 生成100 tokens, 吞吐量=23.30 t/s, 显存=2.60GB
  运行 3/5: 延迟=4.2964s, 生成100 tokens, 吞吐量=23.28 t/s, 显存=2.60GB
  运行 4/5: 延迟=4.2995s, 生成100 tokens, 吞吐量=23.26 t/s, 显存=2.60GB
  运行 5/5: 延迟=4.3012s, 生成100 tokens, 吞吐量=23.25 t/s, 显存=2.60GB

================================================================================
性能测试汇总 (4 种配置)
================================================================================
配置名称                           | 平均延迟(s)      | 吞吐量(t/s)     | 峰值显存(GB)    
--------------------------------------------------------------------------------
Qwen3-4B_输入长度_3_生成_50... | 2.1213      | 23.57       | 2.59
Qwen3-4B_输入长度_3_生成_100... | 4.2628      | 23.46       | 2.59
Qwen3-4B_输入长度_26_生成_50... | 2.1427      | 23.34       | 2.59
Qwen3-4B_输入长度_26_生成_100... | 4.2964      | 23.28       | 2.60
================================================================================


=== 运行性能分析 ===
[W1014 11:52:13.339863542 collection.cpp:1116] Warning: ROCTracer produced duplicate flow start: 1 (function operator())

=== 性能分析摘要 (按CUDA时间排序) ===
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                        model_inference         0.00%       0.000us         0.00%       0.000us       0.000us        7.874s       245.78%        7.874s        7.874s           0 B           0 B           0 B           0 B             1  
                                        model_inference        28.81%        2.268s       100.00%        7.875s        7.875s       0.000us         0.00%        3.204s        3.204s           0 B         -56 B           0 B    -683.99 GB             1  
                                           aten::matmul         0.59%      46.189ms         9.34%     735.450ms      28.955us       0.000us         0.00%        1.118s      44.016us           0 B           0 B     244.21 MB           0 B         25400  
                                               aten::mm         7.39%     581.903ms         8.63%     679.971ms      26.876us        1.118s        34.89%        1.118s      44.173us           0 B           0 B     244.16 MB     244.16 MB         25300  
                       triton_poi_fused_index_mul_sub_0         2.89%     227.825ms         5.13%     404.202ms      16.040us        1.023s        31.93%        1.023s      40.591us           0 B           0 B           0 B           0 B         25200  
                       triton_poi_fused_index_mul_sub_0         0.00%       0.000us         0.00%       0.000us       0.000us        1.023s        31.93%        1.023s      40.591us           0 B           0 B           0 B           0 B         25200  
                             Torch-Compiled Region: 0/8         5.02%     395.430ms         7.18%     565.202ms      78.500us       0.000us         0.00%     485.439ms      67.422us           0 B           0 B     337.50 GB     337.50 GB          7200  
Cijk_Ailk_Bljk_HHS_BH_MT64x64x32_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us     362.917ms        11.33%     362.917ms      50.405us           0 B           0 B           0 B           0 B          7200  
Cijk_Ailk_Bljk_HHS_BH_MT64x64x32_MI16x16x16x1_SN_1LD...         0.00%       0.000us         0.00%       0.000us       0.000us     290.583ms         9.07%     290.583ms      80.717us           0 B           0 B           0 B           0 B          3600  
                                              aten::mul         3.26%     256.458ms         5.04%     396.848ms       8.372us     280.990ms         8.77%     280.990ms       5.928us           0 B           0 B     356.70 MB     356.70 MB         47400  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 7.875s
Self CUDA time total: 3.204s
```